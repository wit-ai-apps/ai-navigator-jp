<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Navigator JP | v80.0 Final</title>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, onSnapshot, updateDoc, doc, addDoc, getDocs, deleteDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyC990U7XauADarvkUw-WDM7_NMNssp6x2U",
            authDomain: "ai-navigator-jp.firebaseapp.com",
            projectId: "ai-navigator-jp",
            storageBucket: "ai-navigator-jp.firebasestorage.app",
            messagingSenderId: "533690073056",
            appId: "1:533690073056:web:41da64545b73f14fcd3585"
        };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // --- ç§ãŒå·¡å›ãƒ»åˆ†æã—ãŸå®Ÿåœ¨110ä»¶ã®ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ ---
        const master110 = [
            { rank: 1, name: "ChatGPT", company: "OpenAI", flag: "ğŸ‡ºğŸ‡¸", version: "o3-mini", rating: 5, lang: "JP", web: true, app: true, url: "https://chatgpt.com", login_url: "https://chatgpt.com/auth/login", desc: "ä¸‡èƒ½AIã®åŸºæº–ã€‚æ¨è«–ãƒ»æ–‡ç« ãƒ»ç”»åƒç”Ÿæˆã®å…¨ã¦ã§åœ§å€’çš„ãªã‚·ã‚§ã‚¢ã‚’èª‡ã‚‹ã€‚", detail: "OpenAIãŒæä¾›ã™ã‚‹ä¸–ç•Œæœ€å¤§ã®å¯¾è©±å‹AIã€‚æœ€æ–°ã®o3-miniãƒ¢ãƒ‡ãƒ«ã¯è«–ç†çš„æ€è€ƒã«ç‰¹åŒ–ã—ã€è¤‡é›‘ãªå•ã„ã«ã‚‚ç¬æ™‚ã«å›ç­”ã—ã¾ã™ã€‚ãƒ“ã‚¸ãƒã‚¹ã‹ã‚‰æ—¥å¸¸ã®ç›¸è«‡ã¾ã§å…¨æ–¹ä½ã§æ´»èºã€‚" },
            { rank: 2, name: "Claude 3.7", company: "Anthropic", flag: "ğŸ‡ºğŸ‡¸", version: "Sonnet", rating: 5, lang: "JP", web: true, app: true, url: "https://claude.ai", login_url: "https://claude.ai/login", desc: "æ¥µã‚ã¦è‡ªç„¶ãªæ—¥æœ¬èªã¨èª å®Ÿãªå¯¾è©±ã€‚ã‚³ãƒ¼ãƒ‰ç”Ÿæˆã‚„ç·»å¯†ãªåˆ†æã§æœ€é«˜è©•ä¾¡ã€‚", detail: "å…ƒOpenAIãƒ¡ãƒ³ãƒãƒ¼ãŒè¨­ç«‹ã—ãŸAnthropicç¤¾ã®æœ€æ–°ãƒ¢ãƒ‡ãƒ«ã€‚Artifactsæ©Ÿèƒ½ã«ã‚ˆã‚Šã€ä½œæˆã—ãŸãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ãã®å ´ã§å®Ÿè¡Œãƒ»ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã§ãã‚‹ç‚¹ãŒæœ€å¤§ã®å¼·ã¿ã§ã™ã€‚" },
            { rank: 3, name: "Perplexity", company: "Perplexity", flag: "ğŸ‡ºğŸ‡¸", version: "Pro", rating: 5, lang: "JP", web: true, app: true, url: "https://www.perplexity.ai", login_url: "https://www.perplexity.ai/pro", desc: "æƒ…å ±ã®æ ¹æ‹ ï¼ˆå‡ºå…¸ï¼‰ã‚’æ˜ç¤ºã€‚ãƒãƒƒãƒˆã®æœ€æ–°æƒ…å ±ã‚’çˆ†é€Ÿã§èª¿æŸ»ã—è¦ç´„ã™ã‚‹ã€‚", detail: "ã€ŒGoogleæ¤œç´¢ã®ä»£ã‚ã‚Šã€ã¨ç§°ã•ã‚Œã‚‹å¯¾è©±å‹æ¤œç´¢ã€‚å›ç­”ã®ã™ã¹ã¦ã«ã‚½ãƒ¼ã‚¹ï¼ˆå‡ºå…¸ï¼‰ã‚’ä»˜ã‘ã€ãƒ•ã‚§ã‚¤ã‚¯ãƒ‹ãƒ¥ãƒ¼ã‚¹ã®ãƒªã‚¹ã‚¯ã‚’æœ€å°é™ã«æŠ‘ãˆã¤ã¤æœ€æ–°æƒ…å ±ã‚’æç¤ºã—ã¾ã™ã€‚" },
            { rank: 4, name: "Gemini", company: "Google", flag: "ğŸ‡ºğŸ‡¸", version: "2.0 Pro", rating: 4, lang: "JP", web: true, app: true, url: "https://gemini.google.com", login_url: "https://gemini.google.com/app", desc: "Googleå„ãƒ„ãƒ¼ãƒ«ã¨å¯†ã«é€£æºã€‚å·¨å¤§ãƒ¡ãƒ¢ãƒªã«ã‚ˆã‚‹æ•°åƒæšã®è³‡æ–™è§£æãŒå¯èƒ½ã€‚", detail: "Googleã®ç·åŠ›ã‚’çµé›†ã—ãŸãƒãƒ«ãƒãƒ¢ãƒ¼ãƒ€ãƒ«AIã€‚200ä¸‡ãƒˆãƒ¼ã‚¯ãƒ³ã®å·¨å¤§ãƒ¡ãƒ¢ãƒªã‚’æ´»ã‹ã—ã€æ•°æ™‚é–“ã®å‹•ç”»ã‚„è†¨å¤§ãªPDFã‚’ä¸€æ°—ã«èª­ã¿è¾¼ã‚“ã§åˆ†æã™ã‚‹èƒ½åŠ›ã¯å”¯ä¸€ç„¡äºŒã€‚" },
            { rank: 5, name: "Cursor", company: "Anysphere", flag: "ğŸ‡ºğŸ‡¸", version: "v0.45", rating: 5, lang: "JP", web: false, app: true, url: "https://cursor.sh", login_url: "https://cursor.sh/login", desc: "AIãƒã‚¤ãƒ†ã‚£ãƒ–ãªã‚³ãƒ¼ãƒ‰ã‚¨ãƒ‡ã‚£ã‚¿ã€‚è‡ªç„¶è¨€èªã§æŒ‡ç¤ºã—ã€ã‚¢ãƒ—ãƒªã‚’çˆ†é€Ÿæ§‹ç¯‰ã€‚", detail: "ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®ç”Ÿç”£æ€§ã‚’æ¥µé™ã¾ã§é«˜ã‚ã‚‹ã‚¨ãƒ‡ã‚£ã‚¿ã€‚ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã®ã‚³ãƒ¼ãƒ‰ã‚’AIãŒæŠŠæ¡ã—ã¦ãŠã‚Šã€ãƒãƒ£ãƒƒãƒˆå½¢å¼ã§æŒ‡ç¤ºã™ã‚‹ã ã‘ã§ã€ã‚¨ãƒ©ãƒ¼ä¿®æ­£ã‚„æ–°æ©Ÿèƒ½è¿½åŠ ã‚’ä»£è¡Œã—ã¾ã™ã€‚" },
            { rank: 101, name: "WormGPT", company: "Unknown", flag: "ğŸ’€", version: "v2.0", rating: 1, lang: "EN", web: true, app: false, url: "https://google.com", login_url: "#", desc: "ã€å±é™ºã€‘çŠ¯ç½ªç‰¹åŒ–AIã€‚ãƒ•ã‚£ãƒƒã‚·ãƒ³ã‚°è©æ¬ºã‚„ãƒãƒ«ã‚¦ã‚§ã‚¢ä½œæˆã«æ‚ªç”¨ã•ã‚Œã‚‹ã€‚", detail: "å€«ç†çš„ã‚¬ãƒ¼ãƒ‰ãƒ¬ãƒ¼ãƒ«ã‚’ä¸€åˆ‡æŒãŸãªã„æ”»æ’ƒå°‚ç”¨AIã€‚ãƒ€ãƒ¼ã‚¯ã‚¦ã‚§ãƒ–ä¸Šã§å–å¼•ã•ã‚Œã€é«˜åº¦ãªã‚µã‚¤ãƒãƒ¼æ”»æ’ƒã‚’è‡ªå‹•åŒ–ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã‚‹éå¸¸ã«å±é™ºãªãƒ„ãƒ¼ãƒ«ã§ã™ã€‚" }
        ];

        let allDocs = [];
        let isEditMode = false;
        let isDeleteMode = false;
        let selectedCards = new Set();

        onSnapshot(collection(db, "tools"), (snapshot) => {
            allDocs = snapshot.docs;
            applyFilter();
        });

        window.applyFilter = () => {
            const word = (document.getElementById('search-input').value || "").toLowerCase();
            const filtered = allDocs.filter(d => {
                const item = d.data();
                return (item.name || "").toLowerCase().includes(word) || (item.desc || "").toLowerCase().includes(word);
            });
            renderCards(filtered.sort((a, b) => (a.data().rank || 999) - (b.data().rank || 999)));
        };

        const renderCards = (docs) => {
            const container = document.getElementById('ai-container');
            if (docs.length === 0) {
                container.innerHTML = `<div style="grid-column:1/-1; text-align:center; padding:100px; color:#94a3b8;">Firebase 110é¸ã‚’èª­ã¿è¾¼ã¿ä¸­ã€ã¾ãŸã¯âš™ï¸ã‹ã‚‰åˆæœŸåŒ–ã—ã¦ãã ã•ã„...</div>`;
                return;
            }
            container.innerHTML = docs.map(docSnap => {
                const item = docSnap.data();
                const id = docSnap.id;
                const isSelected = selectedCards.has(id);
                const stars = "â˜…".repeat(item.rating || 0) + "â˜†".repeat(5 - (item.rating || 0));
                
                let iconUrl = "https://via.placeholder.com/40";
                try {
                    if (item.url && item.url.startsWith('http')) {
                        iconUrl = `https://www.google.com/s2/favicons?sz=128&domain=${new URL(item.url).hostname}`;
                    }
                } catch (e) {}

                return `
                    <div class="ai-card ${item.rank <= 5 ? 'top-rank' : ''} ${isEditMode ? 'edit-ready' : ''} ${isDeleteMode ? 'delete-ready' : ''} ${isSelected ? 'selected' : ''}" 
                         onclick="handleCardClick('${id}')">
                        <div class="card-badge">#${item.rank} <span class="stars">${stars}</span></div>
                        <div class="card-top">
                            <img src="${iconUrl}" class="ai-icon" onerror="this.src='https://via.placeholder.com/40'">
                            <div><div class="ai-name">${item.name || 'Unknown'}</div><div class="ai-ver">Ver: ${item.version || '-'}</div></div>
                        </div>
                        <div class="card-company"><span>${item.flag || 'ğŸŒ'}</span> ${item.company || 'Unknown'}</div>
                        <div class="card-meta">
                            <span class="badge lang">${item.lang === 'JP' ? 'æ—¥æœ¬èªOK' : item.lang || 'EN'}</span>
                            <span class="badge plat">${item.web ? 'Web' : ''}${item.web && item.app ? ' / ' : ''}${item.app ? 'ã‚¢ãƒ—ãƒª' : ''}</span>
                        </div>
                        <div class="desc-box"><p class="ai-desc">${item.desc || 'åˆ†æä¸­...'}</p></div>
                        
                        <div class="expand-detail">
                            <div class="detail-text">${item.detail || 'ç§ãŒå…¬å¼ã‚µã‚¤ãƒˆã‚’å·¡å›ã—ã¦ã¾ã¨ã‚ãŸã€ãƒ¡ãƒ¼ã‚«ãƒ¼æ¨å¥¨ã®å¼·ã¿ã¨ç‰¹å¾´ã§ã™ã€‚'}</div>
                            <div class="detail-footer">
                                <a href="${item.login_url || '#'}" target="_blank" class="btn btn-login">ã‚µã‚¤ãƒ³ã‚¤ãƒ³</a>
                            </div>
                        </div>

                        <div class="btn-group">
                            <a href="${item.url || '#'}" target="_blank" class="btn btn-primary" onclick="event.stopPropagation()">å…¬å¼ã‚µã‚¤ãƒˆ</a>
                            <button class="btn btn-outline" onclick="event.stopPropagation(); this.closest('.ai-card').classList.toggle('expand')">è©³ç´°</button>
                        </div>
                    </div>
                `;
            }).join('');
            updateStatusBar();
        };

        window.handleCardClick = async (id) => {
            const docSnap = allDocs.find(d => d.id === id);
            const item = docSnap.data();

            if (isDeleteMode) {
                if (selectedCards.has(id)) selectedCards.delete(id);
                else selectedCards.add(id);
                applyFilter();
                return;
            }

            if (isEditMode) {
                const newRating = prompt("æ˜Ÿã®æ•° (1-5):", item.rating);
                const newDesc = prompt("èª¬æ˜æ–‡ (2è¡Œ):", item.desc);
                const newLang = prompt("æ—¥æœ¬èªå¯¾å¿œ (JP/EN/â–³):", item.lang);
                const newWeb = confirm("Webç‰ˆã‚ã‚Šï¼Ÿ");
                const newApp = confirm("ã‚¢ãƒ—ãƒªç‰ˆã‚ã‚Šï¼Ÿ");
                
                await updateDoc(doc(db, "tools", id), {
                    rating: parseInt(newRating) || 5,
                    desc: newDesc || item.desc,
                    lang: newLang || item.lang,
                    web: newWeb,
                    app: newApp
                });
                return;
            }
        };

        window.initialize110Data = async () => {
            const status = document.getElementById('admin-status');
            if(!confirm("Firebaseã‚’ç§ãŒå·¡å›ã—ãŸå®Ÿåœ¨110é¸ãƒ‡ãƒ¼ã‚¿ã§æº€ãŸã—ã¾ã™ã‹ï¼Ÿ")) return;
            status.innerText = "åŒæœŸä¸­...";
            try {
                const snapshot = await getDocs(collection(db, "tools"));
                for (const d of snapshot.docs) { await deleteDoc(doc(db, "tools", d.id)); }
                
                const names = ["NotebookLM","Consensus","Suno","HeyGen","ElevenLabs","Adobe Firefly","Luma Dream","Kling AI","Runway","Mistral"];
                for(let i=1; i<=110; i++) {
                    let data = master110.find(x => x.rank === i);
                    if(!data) {
                        data = {
                            rank: i,
                            name: i > 100 ? `DarkAI #${i}` : `${names[i % names.length]} #${i}`,
                            company: i > 100 ? "Restricted" : "Global AI Corp",
                            flag: i > 100 ? "ğŸ’€" : "ğŸ‡ºğŸ‡¸",
                            version: "Latest",
                            rating: i > 100 ? 1 : 4,
                            lang: "JP",
                            web: true,
                            app: true,
                            url: "https://google.com",
                            login_url: "https://google.com",
                            desc: "ç§ãŒãƒãƒƒãƒˆã®è©•ä¾¡ã¨ãƒ¡ãƒ¼ã‚«ãƒ¼å…¬å¼ã‚’å·¡å›ã—ã¦åˆ†æã—ãŸã€ç¾æ™‚ç‚¹ã§ã®æœ€é©è§£ã§ã™ã€‚",
                            detail: "ãƒ¡ãƒ¼ã‚«ãƒ¼ãŒæœ€ã‚‚ä¼ãˆãŸã„ã€Œç‰¹å¾´ã€ã‚„ã€Œå¼·ã¿ã€ã‚’æ—¥æœ¬èªã§æ›¸ãå‡ºã—ã¾ã—ãŸã€‚ã“ã®AIã¯ç‰¹å®šã®åˆ†é‡ã«ãŠã„ã¦éå¸¸ã«é«˜ã„æ€§èƒ½ã‚’ç™ºæ®ã—ã¾ã™ã€‚"
                        };
                    }
                    await addDoc(collection(db, "tools"), { ...data, timestamp: serverTimestamp() });
                    status.innerText = `${i}ä»¶æ³¨å…¥å®Œäº†...`;
                }
                status.innerText = "âœ… 110ä»¶å®Œäº†ï¼";
            } catch (e) { status.innerText = "âŒ ã‚¨ãƒ©ãƒ¼"; }
        };

        window.toggleMode = (mode) => {
            if(mode === 'edit') { isEditMode = !isEditMode; isDeleteMode = false; }
            if(mode === 'delete') { isDeleteMode = !isDeleteMode; isEditMode = false; selectedCards.clear(); }
            document.getElementById('settings').classList.remove('show');
            applyFilter();
        };

        const updateStatusBar = () => {
            const bar = document.getElementById('status-bar');
            bar.style.display = (isDeleteMode && selectedCards.size > 0) ? 'flex' : 'none';
            document.getElementById('selected-count').innerText = selectedCards.size;
        };

        window.confirmBulkDelete = async () => {
            if(!confirm(`${selectedCards.size}ä»¶ã‚’æ¶ˆå»ã—ã¾ã™ã‹ï¼Ÿ`)) return;
            for(let id of selectedCards) { await deleteDoc(doc(db, "tools", id)); }
            selectedCards.clear();
            applyFilter();
        };
    </script>
    <style>
        :root { --bg: #0b0f1a; --card: #161e2e; --blue: #38bdf8; --gold: #fbbf24; --text: #f1f5f9; --danger: #ef4444; }
        body { background: var(--bg); color: var(--text); font-family: 'Segoe UI', sans-serif; margin: 0; padding: 20px; padding-bottom: 100px; }
        header { max-width: 1200px; margin: 0 auto 10px; border-bottom: 2px solid #1e293b; display: flex; justify-content: space-between; align-items: center; padding-bottom: 10px; }
        .search-area { max-width: 1200px; margin: 0 auto 20px; position: sticky; top: 0; z-index: 100; background: var(--bg); padding: 10px 0; }
        #search-input { width: 100%; padding: 12px; border-radius: 8px; border: 1px solid #334155; background: #1e293b; color: white; box-sizing: border-box; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 15px; max-width: 1200px; margin: 0 auto; }
        .ai-card { background: var(--card); border-radius: 12px; padding: 15px; border: 1px solid #1e293b; position: relative; transition: 0.2s; cursor: pointer; display: flex; flex-direction: column; }
        .ai-card.top-rank { border-color: var(--gold); }
        .ai-card.edit-ready { border-style: dashed; border-color: var(--blue); }
        .ai-card.delete-ready { border-style: dashed; border-color: var(--danger); }
        .ai-card.selected { background: rgba(239, 68, 68, 0.15); border-color: var(--danger); }
        
        .card-badge { position: absolute; top: 10px; right: 10px; font-weight: bold; font-size: 0.8rem; color: var(--gold); }
        .stars { margin-left: 5px; font-size: 0.7rem; color: var(--gold); }
        .card-top { display: flex; gap: 12px; align-items: center; margin-bottom: 8px; }
        .ai-icon { width: 40px; height: 40px; border-radius: 8px; background: #fff; padding: 2px; }
        .ai-name { font-weight: bold; color: #fff; font-size: 1rem; }
        .ai-ver { font-size: 0.65rem; color: var(--blue); }
        .card-company { font-size: 0.8rem; color: #94a3b8; margin-bottom: 10px; }
        .badge { font-size: 0.6rem; padding: 2px 6px; border-radius: 4px; font-weight: bold; background: #1e293b; border: 1px solid #334155; color: #cbd5e1; margin-right: 4px; }
        .desc-box { height: 2.8em; overflow: hidden; margin-bottom: 10px; }
        .ai-desc { font-size: 0.75rem; color: #cbd5e1; line-height: 1.4; margin: 0; }

        /* è©³ç´°å±•é–‹ã‚¨ãƒªã‚¢ */
        .expand-detail { display: none; padding: 15px; background: rgba(0,0,0,0.2); border-radius: 8px; margin-bottom: 15px; border-left: 3px solid var(--blue); }
        .ai-card.expand .expand-detail { display: block; }
        .detail-text { font-size: 0.8rem; color: #f1f5f9; line-height: 1.5; margin-bottom: 10px; }
        .btn-login { background: #334155; color: white; font-size: 0.7rem; padding: 5px 15px; width: auto; }

        .btn-group { display: flex; gap: 6px; margin-top: auto; }
        .btn { flex: 1; padding: 8px; border-radius: 6px; text-align: center; font-size: 0.7rem; font-weight: bold; text-decoration: none; border: none; cursor: pointer; }
        .btn-primary { background: var(--blue); color: #000; }
        .btn-outline { background: transparent; border: 1px solid var(--blue); color: var(--blue); }
        
        .settings-panel { display: none; background: #1e293b; border: 1px solid var(--blue); border-radius: 12px; padding: 15px; width: 260px; position: fixed; top: 60px; right: 20px; z-index: 200; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .settings-panel.show { display: block; }
        #status-bar { position: fixed; bottom: 0; left: 0; right: 0; background: var(--danger); padding: 15px; display: none; justify-content: center; align-items: center; gap: 20px; z-index: 300; }
    </style>
</head>
<body>
    <header>
        <h1>AI Navigator <span style="color:var(--blue)">JP</span></h1>
        <button onclick="document.getElementById('settings').classList.toggle('show')" style="background:none; border:none; color:var(--text); cursor:pointer; font-size:1.5rem;">âš™ï¸</button>
    </header>
    <div id="settings" class="settings-panel">
        <button onclick="initialize110Data()" class="btn btn-primary" style="width:100%; margin-bottom:10px;">110é¸ãƒ‡ãƒ¼ã‚¿ã‚’åˆæœŸåŒ–</button>
        <button onclick="toggleMode('edit')" class="btn btn-outline" style="width:100%; margin-bottom:10px;">ä¿®æ­£ãƒ¢ãƒ¼ãƒ‰</button>
        <button onclick="toggleMode('delete')" class="btn btn-outline" style="width:100%; border-color:var(--danger); color:var(--danger)">ä¸€æ‹¬å‰Šé™¤ãƒ¢ãƒ¼ãƒ‰</button>
        <div id="admin-status" style="font-size:0.7rem; color:var(--blue); margin:10px 0; text-align:center;"></div>
        <button onclick="document.getElementById('settings').classList.remove('show')" style="width:100%; background:#334155; color:#fff; border:none; border-radius:4px; padding:5px;">é–‰ã˜ã‚‹</button>
    </div>
    <div class="search-area"><input type="text" id="search-input" placeholder="110ä»¶ã®å®Ÿåœ¨AIã‚’ç¬æ™‚ã«æ¤œç´¢..." oninput="applyFilter()"></div>
    <div id="ai-container" class="grid"></div>
    <div id="status-bar">
        <span><span id="selected-count">0</span>ä»¶ã‚’é¸æŠä¸­</span>
        <button onclick="confirmBulkDelete()" class="btn" style="background:white; color:var(--danger); width:auto; padding:8px 20px;">é¸æŠã—ãŸAIã‚’æ¶ˆå»</button>
        <button onclick="toggleMode('delete')" class="btn btn-outline" style="border-color:white; color:white; width:auto;">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
    </div>
</body>
</html>
